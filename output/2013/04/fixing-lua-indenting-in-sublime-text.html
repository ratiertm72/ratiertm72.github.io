<!doctype html><html lang=ko><meta charset=utf-8><meta content=ie=edge http-equiv=x-ua-compatible><meta name=description><meta content=width=device-width,height=device-height,initial-scale=1 name=viewport><title>lchfkorea</title><meta content=lua name=tags><meta content=sublime-text name=tags><meta content=lchfkorea property=og:site_name><meta content=article property=og:type><meta content="Fixing Lua indenting in Sublime Text" property=og:title><meta content=../../2013/04/fixing-lua-indenting-in-sublime-text.html property=og:url><meta content="I recently started using Sublime Text 2 to edit the Lua project I'm working on, however, it did a couple strange things with indenting. Here is how I fixed them." property=og:description><meta content=2013-04-10 property=article:published_time><meta content=Misc property=article:section><meta content=lua property=article:tag><meta content=sublime-text property=article:tag><meta content="DongBuem Lee" property=article:author><link href=../../theme/icons/apple-touch-icon-57x57.png rel=apple-touch-icon sizes=57x57><link href=../../theme/icons/apple-touch-icon-60x60.png rel=apple-touch-icon sizes=60x60><link href=../../theme/icons/apple-touch-icon-72x72.png rel=apple-touch-icon sizes=72x72><link href=../../theme/icons/apple-touch-icon-76x76.png rel=apple-touch-icon sizes=76x76><link href=../../theme/icons/apple-touch-icon-114x114.png rel=apple-touch-icon sizes=114x114><link href=../../theme/icons/apple-touch-icon-120x120.png rel=apple-touch-icon sizes=120x120><link href=../../theme/icons/apple-touch-icon-144x144.png rel=apple-touch-icon sizes=144x144><link href=../../theme/icons/apple-touch-icon-152x152.png rel=apple-touch-icon sizes=152x152><link href=../../theme/icons/apple-touch-icon-180x180.png rel=apple-touch-icon sizes=180x180><link href=../../theme/icons/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=../../theme/icons/android-chrome-192x192.png rel=icon sizes=192x192 type=image/png><link href=../../theme/icons/favicon-96x96.png rel=icon sizes=96x96 type=image/png><link href=../../theme/icons/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=../../theme/icons/manifest.json rel=manifest><link rel="shortcut icon" href=../../theme/icons/favicon.ico><meta content=#00aba9 name=msapplication-TileColor><meta content=theme/icons/mstile-144x144.png name=msapplication-TileImage><meta content=theme/icons/browserconfig.xml name=msapplication-config><meta content=#ffffff name=theme-color><link href=https://fonts.googleapis.com/css?family=Open+Sans:400,700|Oswald:400,700 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css rel=stylesheet><link href=../../theme/styles/theme.css rel=stylesheet><body><header id=main-header><ul id=main-menu role=nav><li><a href=../../category/graphics.html>Graphics</a><li class=active><a href=../../category/misc.html>misc</a><li><a href=../../category/mobile.html>Mobile</a><li><a href=../../category/web.html>Web</a></ul><section id=masthead><img src=../../theme/images/toaster.png><h1><a href=../../>lchfkorea</a></h1><p>first trys by MindBuild</section></header><header id=article-header><div id=title><h2><a title="Permalink to Fixing Lua indenting in Sublime Text" href=../../2013/04/fixing-lua-indenting-in-sublime-text.html rel=bookmark> Fixing Lua indenting in Sublime Text </a></h2><footer><time class=published datetime=2013-04-10T00:00:00+09:00>4월 10, 2013</time></footer></div></header><section id=article><div class=markdown id=article-content><p><em>Updated September 18th, 2015: Added info on making the same changes to latest ST2 and ST3 build 3083</em><p>I recently started using Sublime Text to edit the Lua project I'm working on, however, it did a couple strange things with indenting. Here is how I fixed them.<p>First, open the file we need to edit in your Sublime Packages Lua directory.<h4>Sublime Text 2:</h4><ul><li>Find your Packages directory by going to <strong>Preferences</strong> -> <strong>Browse Packages...</strong> in Sublime Text.<li>Open the <strong>Lua</strong> folder<li>Edit the <strong>Indent.tmPreferences</strong> file</ul><h4>Sublime Text 3:</h4><ul><li>Install PackageResourceViewer using Package Control or from https://github.com/skuroda/PackageResourceViewer<li>Run <strong>PackageResourceViewer: Open Resource</strong><li>Select <em>Lua</em> then <em>Indent.tmPreferences</em></ul><p>In that file you'll see keys labeled, <code>increaseIndentPattern</code> and <code>decreaseIndentPattern</code> with accompanying regexes wrapped in <code>&LTstring></code> entities. We'll be editing those for these two fixes.<h3>Nested curly brace indentation</h3><p>First, whenever you nested curly braces, indenting any curly braces after the first one would end up with something like this:<p><img alt="Invalid tabbing for nested curly braces" src=../../images/fixing-sublime-lua/sublime_curly_bad.png><p>When instead we want something like this:<p><img alt="Valid tabbing for nested curly braces" src=../../images/fixing-sublime-lua/sublime_curly_good.png><p>The fix for this is pretty easy. We want to edit the <code>increaseIndentPattern</code><div class=highlight><pre><span></span><code><span class=nt>&LTkey></span>increaseIndentPattern<span class=nt>&LT/key></span>
<span class=nt>&LTstring></span>^\s*(else|elseif|for|(local\s+)?function|if|repeat|until|while)\b((?!end).)*$|.*\{\s*$<span class=nt>&LT/string></span>
</code></pre></div><p>The first half is concerned with matching keywords like "if" and "for", but without also having "end" on the same line. The latter half is the part we care about.<div class=highlight><pre><span></span><code><span class=o>|\</span><span class=p>{</span><span class=o>\</span><span class=n>s</span><span class=o>*</span><span class=nv>$</span>
</code></pre></div><p>This matches a curly brace followed by zero or more whitespace characters then the EOL. At first glance this seems like it would work. The fix, weirdly enough, is to match anything before the curly brace as well. So we add ".*" which matches any character zero or more times. I think it might be because sublime throws out any partial matches to prevent erroneous indents. It wants the whole line to be matched. So the fix looks like:<div class=highlight><pre><span></span><code><span class=o>|.*\</span><span class=p>{</span><span class=o>\</span><span class=n>s</span><span class=o>*</span><span class=nv>$</span>
</code></pre></div><p>This does mean that it will indent ANY line ending in a curly brace.<h3>Strange indentation of "elseif"</h3><p>The other problem is improper indentation of the "elseif" statement. Basically sublime gets really confused because it matches "else" then "elseif" and then "elseif" with something after it, and it ends up not recognizing the statement as valid, and doesn't know to unindent it. It looks like this bit of strangeness:<p><img alt="Bad elsif indentation" src=../../images/fixing-sublime-lua/sublime_elseif_bad.gif><p>The problem here lies in the "decreaseIndentPattern" part.<div class=highlight><pre><span></span><code><span class=nt>&LTkey></span>decreaseIndentPattern<span class=nt>&LT/key></span>
<span class=nt>&LTstring></span>^\s*(elseif|else|end|\})\s*$<span class=nt>&LT/string></span>
</code></pre></div><p>This works fine for "else" and "end" because the don't have anything after them. However, "elseif" by it's nature will have text coming after it. So to fix this, we are going to remove "elseif" from this statement, and break it out into its own sub-regex. That way "else" and "end" will continue to work like they should. Then we're going to tell it that "elseif" can have characters after it, but only if there is no "end" after the "elseif". You might have noticed that this sounds like what it does in the "increaseIndentPattern" part. So we can just copy that bit of regex to fit this need as well. We end up with:<div class=highlight><pre><span></span><code><span class=nt>&LTstring></span>^\s*(else|end|\})\s*$|^\s*elseif\b((?!end).)*$<span class=nt>&LT/string></span>
</code></pre></div><p>After the "|" we put in, it matches zero or more whitespace, the word "elseif" followed by a word boundary, then it does a look-ahead to match any character that doesn't follow "end" zero or more times before finding the end-of-line. This results in proper behavior:<p><img alt="Good elsif indentation" src=../../images/fixing-sublime-lua/sublime_elseif_good.gif><h3>Fully fixed file</h3><div class=highlight><pre><span></span><code><span class=cp>&LT?xml version="1.0" encoding="UTF-8"?></span>
<span class=cp>&LT!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"></span>
<span class=nt>&LTplist</span><span class=w> </span><span class=na>version=</span><span class=s>"1.0"</span><span class=nt>></span>
<span class=nt>&LTdict></span>
<span class=w>    </span><span class=nt>&LTkey></span>name<span class=nt>&LT/key></span>
<span class=w>    </span><span class=nt>&LTstring></span>Indent<span class=nt>&LT/string></span>
<span class=w>    </span><span class=nt>&LTkey></span>scope<span class=nt>&LT/key></span>
<span class=w>    </span><span class=nt>&LTstring></span>source.lua<span class=nt>&LT/string></span>
<span class=w>    </span><span class=nt>&LTkey></span>settings<span class=nt>&LT/key></span>
<span class=w>    </span><span class=nt>&LTdict></span>
<span class=w>        </span><span class=nt>&LTkey></span>decreaseIndentPattern<span class=nt>&LT/key></span>
<span class=w>        </span><span class=nt>&LTstring></span>^\s*(else|end|\})\s*$|^\s*elseif\b((?!end).)*$<span class=nt>&LT/string></span>
<span class=w>        </span><span class=nt>&LTkey></span>increaseIndentPattern<span class=nt>&LT/key></span>
<span class=w>        </span><span class=nt>&LTstring></span>^\s*(else|elseif|for|(local\s+)?function|if|repeat|until|while)\b((?!end).)*$|.*\{\s*$<span class=nt>&LT/string></span>
<span class=w>    </span><span class=nt>&LT/dict></span>
<span class=w>    </span><span class=nt>&LTkey></span>uuid<span class=nt>&LT/key></span>
<span class=w>    </span><span class=nt>&LTstring></span>411468A8-E0AC-415A-9E71-E2BD091EB571<span class=nt>&LT/string></span>
<span class=nt>&LT/dict></span>
<span class=nt>&LT/plist></span>
</code></pre></div><h3>Restart Sublime Text</h3><h4>Sublime Text 2:</h4><p>Just restart and your changes should take effect.<h4>Sublime Text 3:</h4><ul><li>Find your Packages directory by going to "Preferences->Browse Packages..." in Sublime Text 3. Leave this window open.<li>Close all Sublime Text 3 windows<li>Back in your file browser window, navigate up one directory then delete the "Cache" directory.<li>Start Sublime Text 3 and it should work now.</ul></div><section id=share-buttons><h3>Share this:</h3><ul><li><a class="btn btn-facebook" href="https://www.facebook.com/sharer/sharer.php?u=../../2013/04/fixing-lua-indenting-in-sublime-text.html&t=Fixing Lua indenting in Sublime Text" title="Share on Facebook" target=_blank> <i class="fa fa-facebook"></i> Facebook </a><li><a class="btn btn-twitter" href="https://twitter.com/intent/tweet?source=../../2013/04/fixing-lua-indenting-in-sublime-text.html&text=Fixing Lua indenting in Sublime Text" target=_blank title=Tweet> <i class="fa fa-twitter"></i> Twitter </a><li><a class="btn btn-reddit" href="http://www.reddit.com/submit?url=../../2013/04/fixing-lua-indenting-in-sublime-text.html&title=Fixing Lua indenting in Sublime Text" title="Submit to Reddit" target=_blank> <i class="fa fa-reddit"></i> Reddit </a><li><a class="btn btn-email" href="mailto:?subject=Fixing Lua indenting in Sublime Text&body=Article+from+lchfkorea%0D%0A%0D%0A../../2013/04/fixing-lua-indenting-in-sublime-text.html%0D%0A%0D%0AI recently started using Sublime Text 2 to edit the Lua project I'm working on, however, it did a couple strange things with indenting. Here is how I fixed them." target=_blank title=Email> <i class="fa fa-envelope"></i> Email </a></ul></section></section><footer id=main-footer><section id=links><section><h3>Pages</h3><ul><li><a href=../../>Home</a><li><a href=../../archives.html>Archives</a><li><a href=../../pages/colophon.html>Colophon</a></ul></section><section><h3>Categories</h3><ul><li><a href=../../category/graphics.html>Graphics</a><li><a href=../../category/misc.html>misc</a><li><a href=../../category/mobile.html>Mobile</a><li><a href=../../category/web.html>Web</a></ul></section><section><h3>Tags</h3><ul class=tag-cloud><li class=tag-1><a href=../../tag/android.html>android</a><li class=tag-1><a href=../../tag/css.html>css</a><li class="tag-1 tag-2"><a href=../../tag/django.html>django</a><li class=tag-1><a href=../../tag/docker.html>docker</a><li class="tag-1 tag-2"><a href=../../tag/elixir.html>elixir</a><li class="tag-1 tag-2 tag-3"><a href=../../tag/gideros.html>gideros</a><li class=tag-1><a href=../../tag/gulp.html>gulp</a><li class=tag-1><a href=../../tag/ios.html>ios</a><li class="tag-1 tag-2 tag-3 tag-4"><a href=../../tag/lua.html>lua</a><li class="tag-1 tag-2"><a href=../../tag/math.html>math</a><li class=tag-1><a href=../../tag/pelican.html>pelican</a><li class="tag-1 tag-2"><a href=../../tag/phoenix.html>phoenix</a><li class=tag-1><a href=../../tag/plug.html>plug</a><li class="tag-1 tag-2"><a href=../../tag/postgres.html>postgres</a><li class=tag-1><a href=../../tag/pycharm.html>pycharm</a><li class=tag-1><a href=../../tag/responsive.html>responsive</a><li class=tag-1><a href=../../tag/sass.html>sass</a><li class=tag-1><a href=../../tag/sublime-text.html>sublime-text</a><li class=tag-1><a href=../../tag/web-design.html>web design</a></ul></section><address><h3>Nathan Shafer</h3> <ul><li><a href=https://www.github.com/nshafer>Github</a><li><a href=http://www.normal-tech.com>Normal Technologies LLC</a><li><a href=http://www.typeingames.com>Type-in Games</a></ul></address></section><section id=subfooter><section id=copyright><p>© 2025 Nathan Shafer<p id=license>All work is licensed under a <a href=http://creativecommons.org/licenses/by/4.0/ rel=license>Creative Commons Attribution 4.0 International License</a> unless otherwise specified.</section><a title="Subscribe to my feed" href=http://feeds.feedburner.com/Lotechnica id=subscribe-link rel=alternate type=application/rss+xml> <img alt src=//feedburner.google.com/fb/images/pub/feed-icon32x32.png style=border:0> </a></section></footer>